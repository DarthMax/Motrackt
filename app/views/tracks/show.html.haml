.row
  .span12
    - model_class = Track
    .page-header
      %h2
        =@track.name ? @track.name : "Untitled Track"
        %small
          =l @track.created_at, :format => :short
          =link_to "Edit", edit_track_path, :method => :get, :class => "btn btn-mini"


    .row
      .span8
        #map

      .span4
        #detail_group.accordion
          .accordion-group
            .accordion-heading
              %strong
                Description
            .accordion-body
              #description.accordion-inner
                =@track.description

          .accordion-group
            .accordion-heading
              %strong
                Distance
            .accordion-body
              #distance.accordion-inner
                =number_with_precision @track.distance
                km

          .accordion-group
            .accordion-heading
              %strong
                Average-Speed
            .accordion-body
              #av-speed.accordion-inner
                =@track.speed
                km/h

          -#
            .accordion-group
              .accordion-heading
                %strong#details-header.accordion-toggle.icon-chevron-up{"data-toggle" => "collapse", "data-target" => "#details"}
                  Details
              #details.accordion-body.collapse.in
                .accordion-inner
                  -@track.positions.each_with_index do |pos,i|
                    %dl
                      %dt= l pos.time,:format => :short
                      %dd
                        %dl
                          %dt= "Coordinates"
                          %dd= "Longitude: #{pos.longitude}, Latitude: #{pos.latitude}"
                          %dt= "Speed"
                          %dd= "#{pos.speed}km/h"
                          %dt= "Height"
                          %dd= "#{pos.height}m"


    =javascript_include_tag "https://maps.google.com/maps/api/js?sensor=false"

    %script
      $(document).ready(function() {
      var list= [];
      -@track.positions.each do |pos|
        ="list.push({lat:#{pos.latitude},lon:#{pos.longitude},id:#{pos.id},speed:#{pos.speed},height:#{pos.height},time:'#{l pos.time,:format => :short}'});"
      draw_map();
      draw_track(list);
      });